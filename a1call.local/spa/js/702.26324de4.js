"use strict";(globalThis["webpackChunkquasar_project"]=globalThis["webpackChunkquasar_project"]||[]).push([[702],{2409:(t,e,a)=>{a.d(e,{f:()=>n});var r=a(7363);const n=(0,r.Q_)("loader",{state:()=>({counter:0}),getters:{isLoading:t=>t.counter>0},actions:{on(){this.counter++},off(){this.counter>0&&this.counter--}}})},7297:(t,e,a)=>{a.d(e,{_:()=>u});a(4110);var r=a(7363),n=a(1947),o=a(1569),i=a(499),l=a(9835);let s=(0,i.iH)(!1);const u=(0,r.Q_)("profile",{state:()=>({name:"anonymous",email:"",avatar:"https://cdn.quasar.dev/img/boy-avatar.png",orders:[],status:{NEW:"Новый",NOT_PAID:"Не оплачен",PAID:"Оплачен",WARNING:"Срок действия подходит к концу",EXPIRED:"Истек срок действия",PENDING_PAID:"Ожидает оплаты",PENDING_CONTINUE_PAID:"Ожидает оплаты для продления тарифа",PARTIAL_PAID:"Часитчно оплачен"}}),getters:{tariffDays:t=>e=>{const a=t.orders.find((t=>t.id===e));if(null===a||void 0===a||!a.start||null===a||void 0===a||!a.expires)return 0;const r=new Date(a.expires),n=new Date(a.start),o=r-n;return Math.round(o/864e5)},tariffExpired(t){return!1},tariffStartDate:t=>e=>{const a=t.orders.find((t=>t.id===e));try{return new Intl.DateTimeFormat(n.Z.lang.getLocale(),{dateStyle:"medium"}).format(new Date(a.start))||a.start}catch(r){return console.log("tariffStartDate format err: ",a.start),a.start}},tariffExpiredDate:t=>e=>{const a=t.orders.find((t=>t.id===e));try{return new Intl.DateTimeFormat(n.Z.lang.getLocale(),{dateStyle:"medium"}).format(new Date(a.expires))||a.expires}catch(r){return console.log("tariffExpiredDate format err: ",a.expires),a.expires}},tariffDayLeft:t=>e=>{const a=t.orders.find((t=>t.id===e));if(null===a||void 0===a||!a.expires||null===a||void 0===a||!a.start)return 0;const r=new Date(a.expires),n=new Date(a.start),o=r-n;return Math.round(o/864e5)},tariffDayLeftPrecent:function(t){return t=>100*this.tariffDayLeft(t)/this.tariffDays(t)},tariff(t){return e=>{var a;const r=t.orders.find((t=>t.id===e));let n=null;try{const t=(null===r||void 0===r?void 0:r.tariff)||null;n=JSON.parse(t)}catch(l){return null}if(null==n)return null;const o={...n};o["daysLeftPrecent"]=this.tariffDayLeftPrecent(e),o["daysLeft"]=this.tariffDayLeft(e),o["days"]=this.tariffDays(e),o["count"]=r.connect_amount,o["raw_status"]=r.status,o["status"]=t.status[r.status],o["ext_data"]=r.tariff_extdata?JSON.parse(r.tariff_extdata):{};const i=null===(a=o["ext_data"])||void 0===a?void 0:a.static;if("undefined"!==typeof i&&null!==i){const t=o["options"].find((t=>{if("IP-адрес"==t.title)return!0}));!0===i?t.value="статический":!1===i&&(t.value="динамический")}return o}},orderItem:t=>e=>t.orders.find((t=>t.id===e))},actions:{async fetch(){return s.value||(s.value=!0,o.api.get("/profile.php").then((t=>{const e=(null===t||void 0===t?void 0:t.data)||null;e&&(this.name=(null===e||void 0===e?void 0:e.fullname)||(null===e||void 0===e?void 0:e.username)||"",this.avatar=(null===e||void 0===e?void 0:e.photo)||"/assets/photouser/default.jpg",this.email=e.email||"",this.logout=e.logout||"/authentication/?service=logout",this.edit=e.edit||"/profile",Array.isArray(e.orders)&&e.orders.length>0?this.orders=e.orders:this.orders=[])})).catch((t=>{console.log(t)})).finally((()=>{s.value=!1}))),new Promise((t=>{const e=(0,l.YP)((()=>1==s.value),(()=>{s.value||(e(),t())}),{immediate:!0})}))},removeOrderById(t){const e=this.orders.findIndex((e=>e.id===t));this.orders.splice(e,1)},update({country:t,monthAmount:e,tariff:a,options:r,count:n,payment_system:i}){const l={action:"new",country:t,monthAmount:e,tariff:a,tariff_extdata:r,count:n,payment_system:i};return o.api.post("/buy.php",l).then((t=>(console.log("profile update: ",t),t))).catch((t=>(console.log("profile update err: ",t),Promise.reject(t))))}}})},1702:(t,e,a)=>{a.r(e),a.d(e,{default:()=>z});var r=a(9835),n=a(6970);function o(t,e,a,o,i,l){const s=(0,r.up)("q-btn"),u=(0,r.up)("q-toolbar-title"),d=(0,r.up)("q-toggle"),c=(0,r.up)("q-toolbar"),f=(0,r.up)("q-header"),p=(0,r.up)("profile-expansion"),m=(0,r.up)("EssentialLink"),w=(0,r.up)("q-list"),g=(0,r.up)("q-scroll-area"),v=(0,r.up)("q-drawer"),h=(0,r.up)("router-view"),_=(0,r.up)("q-page-container"),y=(0,r.up)("q-layout");return(0,r.wg)(),(0,r.j4)(y,{view:"hHh Lpr fFf",class:"shadow-2 rounded-borders"},{default:(0,r.w5)((()=>[(0,r.Wm)(f,{elevated:""},{default:(0,r.w5)((()=>[(0,r.Wm)(c,null,{default:(0,r.w5)((()=>[(0,r.Wm)(s,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:t.toggleLeftDrawer},null,8,["onClick"]),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(t.$t("title")),1)])),_:1}),(0,r.Wm)(d,{color:"dark",modelValue:t.isDark,"onUpdate:modelValue":e[0]||(e[0]=e=>t.isDark=e),"checked-icon":"dark_mode","unchecked-icon":"light_mode",label:t.$t("darkMode")},null,8,["modelValue","label"])])),_:1})])),_:1}),(0,r.Wm)(v,{modelValue:t.leftDrawerOpen,"onUpdate:modelValue":e[1]||(e[1]=e=>t.leftDrawerOpen=e),"show-if-above":""},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{style:{height:"calc(100%)","border-right":"1px solid #ddd"}},{default:(0,r.w5)((()=>[(0,r.Wm)(p),(0,r.Wm)(w,{paddig:""},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.essentialLinks,(e=>((0,r.wg)(),(0,r.iD)(r.HY,{key:e.title},[t.userGroups.some((t=>e.groups.indexOf(t)>=0))?((0,r.wg)(),(0,r.j4)(m,(0,n.vs)((0,r.dG)({key:0},e)),null,16)):(0,r.kq)("",!0)],64)))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,r.Wm)(_,null,{default:(0,r.w5)((()=>[(0,r.Wm)(h)])),_:1})])),_:1})}var i=a(9302),l=a(499),s=a(1569);function u(t,e,a,o,i,l){const s=(0,r.up)("q-icon"),u=(0,r.up)("q-item-section"),d=(0,r.up)("q-item-label"),c=(0,r.up)("q-item"),f=(0,r.up)("router-link");return(0,r.wg)(),(0,r.j4)(f,{to:t.link,custom:""},{default:(0,r.w5)((({route:e,navigate:a,isExactActive:o})=>[(0,r.Wm)(c,{clickable:"",tag:"a",active:o,class:(0,n.C_)({"q-router-link--active":o}),to:e,onClick:a,"active-class":""},{default:(0,r.w5)((()=>[t.icon?((0,r.wg)(),(0,r.j4)(u,{key:0,avatar:""},{default:(0,r.w5)((()=>[(0,r.Wm)(s,{name:t.icon},null,8,["name"])])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(t.title),1)])),_:1}),(0,r.Wm)(d,{caption:""},{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(t.caption),1)])),_:1})])),_:1})])),_:2},1032,["active","class","to","onClick"])])),_:1},8,["to"])}const d=(0,r.aZ)({name:"EssentialLink",props:{title:{type:String,required:!0},caption:{type:String,default:""},link:{type:String,default:""},icon:{type:String,default:""}}});var c=a(1639),f=a(490),p=a(1233),m=a(2857),w=a(3115),g=a(9984),v=a.n(g);const h=(0,c.Z)(d,[["render",u]]),_=h;v()(d,"components",{QItem:f.Z,QItemSection:p.Z,QIcon:m.Z,QItemLabel:w.Z});const y=["src"];function k(t,e,a,o,i,l){const s=(0,r.up)("q-avatar"),u=(0,r.up)("q-item-section"),d=(0,r.up)("q-item-label"),c=(0,r.up)("q-btn"),f=(0,r.up)("q-card-section"),p=(0,r.up)("q-card"),m=(0,r.up)("q-expansion-item"),w=(0,r.up)("q-skeleton"),g=(0,r.up)("q-item");return t.isLoaded?((0,r.wg)(),(0,r.j4)(m,{key:0,class:"q-my-md"},{header:(0,r.w5)((()=>[t.profile.avatar?((0,r.wg)(),(0,r.j4)(u,{key:0,avatar:""},{default:(0,r.w5)((()=>[(0,r.Wm)(s,null,{default:(0,r.w5)((()=>[(0,r._)("img",{src:t.profile.avatar},null,8,y)])),_:1})])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(t.profile.name),1)])),_:1}),(0,r.Wm)(d,{caption:"",lines:"1"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,n.zw)(t.profile.email),1)])),_:1})])),_:1})])),default:(0,r.w5)((()=>[(0,r.Wm)(p,null,{default:(0,r.w5)((()=>[(0,r.Wm)(f,{class:"row justify-around"},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{color:"accent",label:t.$t("edit"),href:t.profile.edit},null,8,["label","href"]),(0,r.Wm)(c,{color:"negative",label:t.$t("logout"),href:t.profile.logout},null,8,["label","href"])])),_:1})])),_:1})])),_:1})):((0,r.wg)(),(0,r.j4)(g,{key:1,class:"q-my-md"},{default:(0,r.w5)((()=>[(0,r.Wm)(u,{avatar:""},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{type:"QAvatar"})])),_:1}),(0,r.Wm)(u,null,{default:(0,r.w5)((()=>[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Wm)(w,{type:"text"})])),_:1}),(0,r.Wm)(d,{caption:""},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{type:"text"})])),_:1})])),_:1})])),_:1}))}a(4110);var D=a(7297),q=a(2409);const W=(0,r.aZ)({name:"ProfileExpansion",setup(){const t=(0,q.f)(),e=(0,D._)(),a=(0,r.Fl)((()=>!t.isLoading));return t.on(),e.fetch().finally(t.off),{isLoaded:a,profile:e}}});var Z=a(651),L=a(1357),b=a(4458),x=a(3190),Q=a(4455),I=a(7133);const A=(0,c.Z)(W,[["render",k]]),P=A;v()(W,"components",{QExpansionItem:Z.Z,QItemSection:p.Z,QAvatar:L.Z,QItemLabel:w.Z,QCard:b.Z,QCardSection:x.Z,QBtn:Q.Z,QItem:f.Z,QSkeleton:I.ZP});const E=[{title:"Текущий тарифный план",caption:"",icon:"verified",link:"/",groups:["Users","Administrator"]},{title:"Новый тарифый план",caption:"Выбрать новый тарифный план",icon:"add_moderator",link:"/new-tariff",groups:["Users","Administrator"]},{title:"Скачать клиент",caption:"Скачайте приложения для ваших устройств",icon:"download",link:"/download",groups:["Users","Administrator"]},{title:"Инструкции",caption:"установка и настройка приложений на ваших устройствах",icon:"checklist_rtl",link:"/manual",groups:["Users","Administrator"]},{title:"Панель менеджера",caption:"Проверка транзакций пользователей",icon:"admin_panel_settings",link:"/manager-panel",groups:["Managers","Administrator"]}],S=(0,r.aZ)({name:"MainLayout",components:{EssentialLink:_,ProfileExpansion:P},setup(){const t=(0,i.Z)(),e=(0,l.iH)(!1),a=(0,l.iH)(t.dark.isActive);(0,r.YP)(a,(e=>{t.dark.set(e)}));const n=(0,l.iH)([]);return s.api.get("/auth.php").then((t=>{n.value=(null===t||void 0===t?void 0:t.data)||[]})).catch((t=>{console.log("MainLayout catch: ",t.message)})),{userGroups:n,essentialLinks:E,isDark:a,leftDrawerOpen:e,toggleLeftDrawer(){e.value=!e.value}}},data(){return{}}});var j=a(249),N=a(6602),U=a(1663),C=a(1973),T=a(3175),O=a(906),H=a(6663),M=a(3246),G=a(2133);const V=(0,c.Z)(S,[["render",o]]),z=V;v()(S,"components",{QLayout:j.Z,QHeader:N.Z,QToolbar:U.Z,QBtn:Q.Z,QToolbarTitle:C.Z,QToggle:T.Z,QDrawer:O.Z,QScrollArea:H.Z,QList:M.Z,QPageContainer:G.Z})}}]);